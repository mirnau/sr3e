@keyframes marquee-move {
  from {
    transform: translateX(var(--ticker-width));
  }

  to {
    transform: translateX(calc(-1 * var(--marquee-width)));
  }
}

.sr3e.sheet.character {
  .window-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: nowrap;

    // Ensure window icon and title don't interfere
    .window-icon,
    .window-title {
      flex: 0 0 auto;
    }

    // Keep header controls on the right
    .header-control {
      flex: 0 0 auto;
      order: 1;
    }

    .news-feed-position {
      flex: 1 1 auto;
      min-width: 0;
      min-height: 2.5rem;
      pointer-events: none;
      display: flex;
      align-items: center;
      order: 0;

      .ticker {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 2.5rem;
        overflow: visible;
        position: relative;

        // Left emitter housing - Vaporwave purple/magenta
        &::before {
          content: "";
          position: absolute;
          left: -4px;
          top: 50%;
          transform: translateY(-50%);
          width: 4px;
          height: 80%;
          background: linear-gradient(to bottom,
              rgba(255, 105, 180, 0) 0%,
              rgba(255, 105, 180, 0.8) 20%,
              rgba(255, 20, 147, 1) 40%,
              rgba(255, 255, 255, 1) 50%,
              rgba(255, 20, 147, 1) 60%,
              rgba(255, 105, 180, 0.8) 80%,
              rgba(255, 105, 180, 0) 100%);
          box-shadow:
            0 0 8px rgba(255, 20, 147, 0.9),
            0 0 16px rgba(255, 105, 180, 0.6),
            0 0 24px rgba(186, 85, 211, 0.4),
            inset 0 0 4px rgba(255, 255, 255, 0.8);
          border-radius: 2px;
          z-index: 5;
          animation: emitter-glow 2s ease-in-out infinite;
        }

        // Right emitter housing - Vaporwave purple/magenta
        &::after {
          content: "";
          position: absolute;
          right: -4px;
          top: 50%;
          transform: translateY(-50%);
          width: 4px;
          height: 80%;
          background: linear-gradient(to bottom,
              rgba(255, 105, 180, 0) 0%,
              rgba(255, 105, 180, 0.8) 20%,
              rgba(255, 20, 147, 1) 40%,
              rgba(255, 255, 255, 1) 50%,
              rgba(255, 20, 147, 1) 60%,
              rgba(255, 105, 180, 0.8) 80%,
              rgba(255, 105, 180, 0) 100%);
          box-shadow:
            0 0 8px rgba(255, 20, 147, 0.9),
            0 0 16px rgba(255, 105, 180, 0.6),
            0 0 24px rgba(186, 85, 211, 0.4),
            inset 0 0 4px rgba(255, 255, 255, 0.8);
          border-radius: 2px;
          z-index: 5;
          animation: emitter-glow 2s ease-in-out infinite;
          animation-delay: 1s;
        }

        .marquee-outer {
          position: relative;
          width: calc(100% - 8px);
          height: 100%;
          overflow: hidden;
          display: flex;
          align-items: center;
          white-space: nowrap;
          backdrop-filter: blur(8px);
          margin: 0 4px;
          mask-image: linear-gradient(to right,
            transparent 0%,
            black 1%,
            black 99%,
            transparent 100%);
          -webkit-mask-image: linear-gradient(to right,
            transparent 0%,
            black 1%,
            black 99%,
            transparent 100%);

          // Left power source emitter - Vaporwave energy field
          &::before {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 50%;
            background:
              linear-gradient(to right,
                rgba(255, 20, 147, 1) 0%,
                rgba(255, 105, 180, 0.8) 10%,
                rgba(186, 85, 211, 0.6) 20%,
                rgba(147, 112, 219, 0.4) 35%,
                rgba(138, 43, 226, 0.2) 50%,
                transparent 100%
              );
            pointer-events: none;
            z-index: 3;
            animation: power-pulse-left 3s ease-in-out infinite;
          }

          // Right power source emitter - Vaporwave energy field
          &::after {
            content: "";
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 50%;
            background:
              linear-gradient(to left,
                rgba(255, 20, 147, 1) 0%,
                rgba(255, 105, 180, 0.8) 10%,
                rgba(186, 85, 211, 0.6) 20%,
                rgba(147, 112, 219, 0.4) 35%,
                rgba(138, 43, 226, 0.2) 50%,
                transparent 100%
              );
            pointer-events: none;
            z-index: 3;
            animation: power-pulse-right 3s ease-in-out infinite;
            animation-delay: 1.5s;
          }

          .marquee-inner {
            display: inline-flex;
            white-space: nowrap;
            animation: marquee-move var(--marquee-duration, 20s) linear infinite;
            animation-delay: var(--marquee-delay, 0s);
            will-change: transform;
            align-items: center;
            height: 100%;

            .marquee-item {
              display: inline-flex;
              align-items: center;
              padding: 0 2rem;
              white-space: nowrap;
              flex-shrink: 0;
              font-size: 1.5rem;
              font-weight: 500;
              color: rgba(0, 255, 255, 0.95);
              text-shadow:
                0 0 2px rgba(255, 255, 255, 0.8),
                0 0 4px rgba(0, 255, 255, 0.6),
                0 0 8px rgba(0, 255, 255, 0.4),
                0 0 12px rgba(0, 255, 255, 0.2),
                0 0 3px oklch(0% 0 0 / 0.4);
              letter-spacing: 0.05em;
              line-height: 1;
              will-change: contents;
              animation: hologram-flicker 4s ease-in-out infinite;

              &:nth-child(2n) {
                animation-delay: 2s;
              }
            }
          }
        }
      }

      // Ensure ticker is visible but doesn't block interactions
      * {
        pointer-events: none;
      }
    }
  }

  // Emitter housing glow animation - Vaporwave purple/magenta
  @keyframes emitter-glow {

    0%,
    100% {
      box-shadow:
        0 0 8px rgba(255, 20, 147, 0.9),
        0 0 16px rgba(255, 105, 180, 0.6),
        0 0 24px rgba(186, 85, 211, 0.4),
        inset 0 0 4px rgba(255, 255, 255, 0.8);
      filter: brightness(1) blur(1px);
    }

    50% {
      box-shadow:
        0 0 12px rgba(255, 20, 147, 1),
        0 0 24px rgba(255, 105, 180, 0.8),
        0 0 36px rgba(186, 85, 211, 0.6),
        0 0 48px rgba(138, 43, 226, 0.4),
        inset 0 0 6px rgba(255, 255, 255, 1);
      filter: brightness(1.5) blur(1.5px);
    }
  }

  // Power source pulsing animations
  @keyframes power-pulse-left {

    0%,
    100% {
      opacity: 0.8;
      filter: brightness(1);
    }

    50% {
      opacity: 1;
      filter: brightness(1.3);
    }
  }

  @keyframes power-pulse-right {

    0%,
    100% {
      opacity: 0.8;
      filter: brightness(1);
    }

    50% {
      opacity: 1;
      filter: brightness(1.3);
    }
  }

  // Holographic text flicker
  @keyframes hologram-flicker {

    0%,
    100% {
      opacity: 0.95;
      text-shadow:
        0 0 2px rgba(255, 255, 255, 0.8),
        0 0 4px rgba(0, 255, 255, 0.6),
        0 0 8px rgba(0, 255, 255, 0.4),
        0 0 12px rgba(0, 255, 255, 0.2),
        0 0 3px oklch(0% 0 0 / 0.4);
    }

    25% {
      opacity: 1;
      text-shadow:
        0 0 3px rgba(255, 255, 255, 1),
        0 0 6px rgba(0, 255, 255, 0.8),
        0 0 10px rgba(0, 255, 255, 0.5),
        0 0 16px rgba(0, 255, 255, 0.3),
        0 0 3px oklch(0% 0 0 / 0.4);
    }

    50% {
      opacity: 0.97;
      text-shadow:
        0 0 2px rgba(255, 255, 255, 0.9),
        0 0 5px rgba(0, 255, 255, 0.7),
        0 0 9px rgba(0, 255, 255, 0.45),
        0 0 14px rgba(0, 255, 255, 0.25),
        0 0 3px oklch(0% 0 0 / 0.4);
    }

    75% {
      opacity: 1;
      text-shadow:
        0 0 3px rgba(255, 255, 255, 1),
        0 0 6px rgba(0, 255, 255, 0.8),
        0 0 10px rgba(0, 255, 255, 0.5),
        0 0 16px rgba(0, 255, 255, 0.3),
        0 0 3px oklch(0% 0 0 / 0.4);
    }
  }

  @keyframes news-glow {

    0%,
    100% {
      text-shadow:
        0 0 3px rgba(0, 0, 0, 0.8),
        0 0 6px rgba(0, 0, 0, 0.6),
        0 0 10px color-mix(in srgb, var(--accent-color) 40%, transparent);
    }

    50% {
      text-shadow:
        0 0 3px rgba(0, 0, 0, 0.8),
        0 0 6px rgba(0, 0, 0, 0.6),
        0 0 10px color-mix(in srgb, var(--accent-color) 60%, transparent),
        0 0 15px color-mix(in srgb, var(--accent-color) 30%, transparent);
    }
  }
}